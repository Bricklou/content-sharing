<header *transloco="let t; read: 'components.navbar'" class="navbar-container">
  <div class="navbar">
    <nav class="menu" role="menubar">
      <div class="submenu menu-start">
        <a
          [routerLinkActiveOptions]="{ exact: true }"
          [title]="t('home')"
          ariaCurrentWhenActive="page"
          class="link"
          routerLink="/"
          routerLinkActive="active">
          <lucide-angular name="home" />
        </a>

        <app-input
          #searchElement
          (blur)="toggleSearch()"
          (keydown.enter)="search()"
          [(ngModel)]="searchValue"
          [ngClass]="{ active: isSearching }"
          [placeholder]="t('search_bar')"
          class="search-bar"
          elId="search-bar"
          type="search" />

        <ng-template [ngIf]="searchValue.length > 0">
          <p (click)="toggleSearch()" [ngClass]="{ active: !isSearching }" class="search-preview">
            {{ searchValue }}
          </p>
        </ng-template>
        <button (click)="toggleSearch()" class="link search-btn" type="button">
          <lucide-angular [name]="isSearching ? 'x' : 'search'" />
        </button>
      </div>

      <div [ngClass]="{ active: isMenuOpened }" class="submenu menu-end">
        <div class="header-buttons">
          <button class="link" type="button">
            <lucide-angular name="sun" />
          </button>
          <button (click)="toggleMenu()" class="link close-btn" type="button">
            <lucide-angular name="x"></lucide-angular>
          </button>
        </div>

        <div class="menu-content">
          <ng-container *ngIf="currentUser; else elseGuest">
            <button (click)="logout()" [title]="t('logout')" class="link logout-btn" type="button">
              <span class="avatar">
                <img
                  *ngIf="currentUser.avatar; else elseNotAvatar"
                  [alt]="currentUser.username + '\'s avatar'"
                  [src]="currentUser.avatar" />

                <ng-template #elseNotAvatar>
                  <lucide-angular class="icon" name="user" />
                </ng-template>
              </span>
              <span class="md:hidden">{{ currentUser.username }}</span>
            </button>
          </ng-container>
          <ng-template #elseGuest>
            <a [title]="t('login')" class="link" routerLink="/login">
              <lucide-angular class="icon" name="log-in" />
              <span class="md:hidden">{{ t('login') }}</span>
            </a>
          </ng-template>
        </div>
      </div>
    </nav>
  </div>
</header>

<button (click)="toggleMenu()" [ngClass]="{ active: isMenuOpened }" class="mobile-nav-btn">
  <lucide-angular name="menu" />
</button>
